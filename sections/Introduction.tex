\chapter{Introduction}
\section{Context}
Electromyography (EMG) is the process of measuring the electrical activity that forms in a muscle in response to a nerve stimulating the muscle fibers \cite{biomechanics_research_methods} \cite{wikipedia_emg}. EMG is an popular method of measuring a person's intent to contract a muscle as it measures the muscle activation rather than the muscle contraction \cite{control_interfaces_intention_detection}. This means that it can still be used in scenarios where muscles can not respond accurately to nerve stimulation due to for example muscular dystrophy \cite{emg_arm_function_boys_pilot}. As a result, EMG is a good way of creating a control interface for exo-aids in various scenarios. Additionally, the amplitude of the EMG signal has a roughly linear relation with the force produced by the muscles and is therefore suitable for human machine interfaces \cite{adaptive_filter_dry_electrode}.

The electrical activity of a muscle can either be measured by probing the inside of a muscle (called intramuscular EMG or iEMG), or by measuring the electrical potential on the surface of the skin (called surface EMG or sEMG). iEMG has a high selectivity for individual motor neuron units which is desirable for a precise control interface registering multiple degree of freedoms \cite{semg_vs_iemg}, but has as a downside that it is an invasive and difficult procedure \cite{intramuscular_emg_signals}. sEMG is a non-invasive method of measuring requiring only sticking electrodes on the skin but this method can only measure the combined electrical activity of many muscle fibers resulting in a noisy and imprecise signal \cite{wiki:Electromyography}. 

During the last 2 decades research has attempted to gather more accurate sEMG readings by increasing the number of electrodes on a muscle with a technique called high-density sEMG \cite{high_density_semg}. 
This technique has allowed the measuring of spatial muscle activation in addition to time domain muscle activation. By measuring the muscle activation of a single muscle at multiple points it is theoretically possible to determine the behaviour of individual motor units \cite{high_density_semg_clinical_applications}.

However, this increased accuracy comes with a catch: Each electrode outputs a single data stream that needs to be processed. Adding more electrodes means having to process more data requiring faster, more efficient, and more accurate data processing techniques to create a system that can provide support in real time.

This project aims to give an overview of the effectiveness of different EMG processing techniques. The effect of whitening the input signal, different filtering techniques, and different envelope detection techniques are discussed, with the overarching goal of performing force estimation from sEMG signals.

\section{Related work}
There are a number of works on applying different filtering techniques in the medical field. Some interesting papers that closely relate to this assignment are discussed.

An example that shows the effectiveness of adaptive filters for real-time signal processing is \cite{adaptive_filter_emg_noise_cancellation_ecg} which covers the removal of an EMG signal from an electrocardiogram (ECG, electrical activity around the heart) signal. This is notable because the signal spectra of EMG and ECG overlap to a large extend and are therefore notoriously hard to remove using static filters. Furthermore it is mentioned in \cite{influence_semg_amplitude_estimation_technique_on_emg_force_relationship} that adaptive filters might be the most suitable type of filters for estimating force from sEMG signals.

The performance of adaptive filters and Wiener filters for noise cancellation in real-time environments in general has been tested in \cite{wiener_vs_adaptive_realtime_noisecancellation}. This report provides a solid groundwork for an intuitive understanding of wiener filters and adaptive filters which are used in this project.

A bold but promising implementation of Wiener filter in sEMG is presented in \cite{wiener_filter_a_priori_semg}. This paper presents the problem of voluntary EMG signals being contaminated by spontaneous unwanted motor activity from paretic muscles in for example stroke or spinal cord injury patients. Since EMG signals from muscles (regardless of which muscles) present similar behaviour in the frequency spectrum \textcolor{red}{(NEED SOURCE ON THIS)} it is nearly impossible to determine whether muscle activity originated from the target muscle or adjacent muscles. The research uses an 'a priori' SNR (deduced from theory, not measurements) to filter the EMG signal from the involuntary muscle contractions. 


A common technique of improving signal to noise ratio (SNR) through pre-processing is 'whitening'. Whitening decorrelates the sEMG signal to yield improved signal accuracy \cite{emg_whitening}. 
Whitening can primarily be used for high-amplitude EMG signals and has trouble retaining effectiveness on low amplitude signals. This problem has been attempted to solve by creating adaptive whitening filter which shows promising results when applied to low EMG amplitude signals \cite{adaptive_whitening}. 

An important paper in the field of EMG signals is \cite{optimal_myoprocessor}. This research assignment aims to provide a fully mathematical solution for an optimal myoelectric signal processor, and to do so a phenomenological mathematical model of myoelectric activity is presented. In other words: This paper uses biology, physics and statistics to create a formula that predicts the EMG signal from muscle activity.

There are several papers related to signal processing of sEMG signals.
One outstanding example is \cite{adaptive_filter_dry_electrode} from 2019, where it is shown that adaptive filters are an effective solution to EMG signal processing. The paper presents the instrumentation scheme of a dry-electrode sEMG measurement setup and explains a method of creating real-time adaptive finite impulse response (FIR) filters. In essence it is very similar to what my research project attempts to achieve, but the paper you are reading right now is aimed at comparing the performance between filters rather than the creation of one.

Lastly I would like to mention that static and adaptive filters are only a subset of the available tools for sEMG signal processing. An emerging topic in this field is the use of machine learning methods for signal analysis. Applying machine learning could allow for very quick, efficient, and effective signal processing, with the downside of unexpected behaviour in certain situations. Where static filters and adaptive filters exhibit deterministic behaviour (which is difficult to confirm in the case of real-time adaptive filters), machine learning methods can be somewhat 'hit or miss'. \cite{ml_semg_processing_1}.
\cite{ml_semg_processing_2}
"In many cases, ML model predictions have been found to be objectionable and violating their original expectations after deployment. A key reason is that ML models are often complex black-boxes and thus have varying, unknown failure modes that are revealed only after deployment" \cite{microsoft_machine_learning_reliable}.

\section{Research goal}
Even though a significant amount of research has been done into the digital processing of sEMG signals, an overview comparing different techniques is lacking. This report aims to give an overview of pre-whitening, different filtering techniques, and different envelope detection techniques. The overaching goal is comparing each method with the goal of \textit{real-time} force estimation. 
In figure \ref{fig:global_thesis_flowchart} a high-level overview of the signal processing chain is presented. 

\begin{figure}[h!t]
	\begin{center}
		\includegraphics[height=60mm]{images/global_thesis_flowchart.png}
	\end{center}
	\caption{High-level overview of the signal processing chain}
	\label{fig:global_thesis_flowchart}
\end{figure}


\section{Approach}
The approach for this project consists of two main steps: Evaluate filter performance on sEMG signals, and evaluate the influence of whitening and different envelope extraction techniques on the lag and error of an estimated force signal.

The filters are assessed by signal to noise ratio (SNR) and signal integrity. Different envelope estimation techniques are evaluated by their lag and error compared to a simulated modulation. The combination of whitening, different filtering techniques, and different envelope extraction techniques is also evaluated through a measurement setup consisting of a 20kg load cell and a multi-channel EMG sensor. This setup is subsequently used to estimate the force from the sEMG signals and compare it to the force measured using the load cell.